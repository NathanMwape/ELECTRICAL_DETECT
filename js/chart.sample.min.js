"use strict";
var chartColors = {
    default: {
        primary: "#00D1B2",
        info: "#209CEE",
        danger: "#FF3860",
    },
};

var ctxCurrent = document.getElementById("currentChart").getContext("2d");
var currentChart = new Chart(ctxCurrent, {
    type: "line",
    data: {
        datasets: [{
            label: "Courant (A)",
            fill: false,
            borderColor: 'red', // Change the line color to red
            borderWidth: 2,
            borderDash: [],
            borderDashOffset: 0,
            pointBackgroundColor: 'red', // Change point color to red
            pointBorderColor: "rgba(255,255,255,0)",
            pointHoverBackgroundColor: 'red', // Change point hover color to red
            pointBorderWidth: 20,
            pointHoverRadius: 4,
            pointHoverBorderWidth: 15,
            pointRadius: 4,
            data: [],
        }],
        labels: [],
    },
    options: {
        maintainAspectRatio: false,
        legend: { display: true },
        responsive: true,
        tooltips: {
            backgroundColor: "#f5f5f5",
            titleFontColor: "#333",
            bodyFontColor: "#666",
            bodySpacing: 4,
            xPadding: 12,
            mode: "nearest",
            intersect: 0,
            position: "nearest",
        },
        scales: {
            yAxes: [{
                barPercentage: 1.6,
                gridLines: {
                    drawBorder: false,
                    color: "rgba(29,140,248,0.0)",
                    zeroLineColor: "transparent",
                },
                ticks: {
                    padding: 20,
                    fontColor: "#9a9a9a",
                },
            }],
            xAxes: [{
                barPercentage: 1.6,
                gridLines: {
                    drawBorder: false,
                    color: "rgba(225,78,202,0.1)",
                    zeroLineColor: "transparent",
                },
                ticks: { padding: 20, fontColor: "#9a9a9a" },
            }],
        },
    },
});

var ctxVoltage = document.getElementById("voltageChart").getContext("2d");
var voltageChart = new Chart(ctxVoltage, {
    type: "line",
    data: {
        datasets: [{
            label: "Tension (V)",
            fill: false,
            borderColor: chartColors.default.info,
            borderWidth: 2,
            borderDash: [],
            borderDashOffset: 0,
            pointBackgroundColor: chartColors.default.info,
            pointBorderColor: "rgba(255,255,255,0)",
            pointHoverBackgroundColor: chartColors.default.info,
            pointBorderWidth: 20,
            pointHoverRadius: 4,
            pointHoverBorderWidth: 15,
            pointRadius: 4,
            data: [],
        }],
        labels: [],
    },
    options: {
        maintainAspectRatio: false,
        legend: { display: true },
        responsive: true,
        tooltips: {
            backgroundColor: "#f5f5f5",
            titleFontColor: "#333",
            bodyFontColor: "#666",
            bodySpacing: 4,
            xPadding: 12,
            mode: "nearest",
            intersect: 0,
            position: "nearest",
        },
        scales: {
            yAxes: [{
                barPercentage: 1.6,
                gridLines: {
                    drawBorder: false,
                    color: "rgba(29,140,248,0.0)",
                    zeroLineColor: "transparent",
                },
                ticks: {
                    padding: 20,
                    fontColor: "#9a9a9a",
                },
            }],
            xAxes: [{
                barPercentage: 1.6,
                gridLines: {
                    drawBorder: false,
                    color: "rgba(225,78,202,0.1)",
                    zeroLineColor: "transparent",
                },
                ticks: { padding: 20, fontColor: "#9a9a9a" },
            }],
        },
    },
});

function updateCharts() {
    // Générer des données aléatoires pour le courant et la tension
    var currentTime = new Date().toLocaleTimeString();
    var randomCurrent = Math.round(Math.random() * 10); // Valeur de courant aléatoire entre 10 A
    var randomVoltage = Math.round(Math.random() * 30 + 200); // Valeur de tension aléatoire entre230 V

    // Ajouter les données aux graphiques
    currentChart.data.labels.push(currentTime);
    currentChart.data.datasets[0].data.push(randomCurrent);
    voltageChart.data.labels.push(currentTime);
    voltageChart.data.datasets[0].data.push(randomVoltage);

    // Limiter le nombre de données affichées pour éviter la surcharge
    var maxDataPoints = 9;
    if (currentChart.data.labels.length > maxDataPoints) {
        currentChart.data.labels.shift();
        currentChart.data.datasets[0].data.shift();
        voltageChart.data.labels.shift();
        voltageChart.data.datasets[0].data.shift();
    }

    // Mettre à jour les graphiques
    currentChart.update();
    voltageChart.update();
}

// Mettre à jour les données toutes les quelques secondes
setInterval(updateCharts, 500); // Mettre à jour toutes les 2 secondes
